{"ast":null,"code":"import _classCallCheck from \"/home/imstaked/explorer/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/home/imstaked/explorer/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport compareVersions from 'compare-versions';\nimport ProposalTally from './proposal-tally';\n\nvar Proposal = /*#__PURE__*/function () {\n  function Proposal() {\n    _classCallCheck(this, Proposal);\n\n    this.element = null;\n    this.id = 0;\n    this.status = 1;\n    this.type = '-';\n    this.title = '-';\n    this.description = '-';\n    this.tally = new ProposalTally();\n    this.submit_time = '0000-00-00';\n    this.voting_end_time = '0000-00-00';\n    this.voting_start_time = '0000-00-00';\n    this.total_deposit = '-';\n    this.contents = null;\n  }\n\n  _createClass(Proposal, [{\n    key: \"init\",\n    value: function init(element, total) {\n      this.element = element;\n      this.id = element.proposal_id || element.id;\n      this.status = element.status;\n      this.tally = new ProposalTally().init(element.final_tally_result, total);\n      this.submit_time = element.submit_time;\n      this.voting_end_time = element.voting_end_time;\n      this.voting_start_time = element.voting_start_time; // eslint-disable-next-line prefer-destructuring\n\n      this.total_deposit = element.total_deposit[0];\n      this.contents = element.content.value || element.content;\n\n      if (this.contents) {\n        this.title = this.contents.title;\n        this.description = this.contents.description;\n        this.type = element.content.type;\n\n        if (element.content['@type']) {\n          this.type = element.content['@type'];\n        }\n      }\n\n      return this;\n    }\n  }, {\n    key: \"hello\",\n    value: function hello() {\n      return this.title;\n    }\n  }, {\n    key: \"updateTally\",\n    value: function updateTally(newTally) {\n      this.tally = newTally;\n    }\n  }, {\n    key: \"versionFixed\",\n    value: function versionFixed(ver) {\n      if (compareVersions(ver, '0.46') >= 0) {\n        if (this.element.metadata) {\n          this.title = this.element.metadata.title || this.element.metadata;\n          this.description = this.element.metadata.description || this.element.metadata;\n        }\n      } else if (compareVersions(ver, '0.30') >= 0) {\n        switch (this.element.proposal_status) {\n          case 'Passed':\n            this.status = 3;\n            break;\n\n          case 'VotingPeriod':\n            this.status = 2;\n            break;\n\n          case 'Rejected':\n            this.status = 4;\n            break;\n\n          default: // this.status = 1\n\n        }\n      }\n\n      if (String(this.status).indexOf('PASSED') > -1) {\n        this.status = 3;\n      } else if (String(this.status).indexOf('VOTING') > -1) {\n        this.status = 2;\n      } else if (String(this.status).indexOf('REJECTED') > -1) {\n        this.status = 4;\n      } else if (String(this.status).indexOf('DEPOSIT') > -1) {\n        this.status = 1;\n      }\n    }\n  }]);\n\n  return Proposal;\n}();\n\nexport { Proposal as default };","map":{"version":3,"names":["compareVersions","ProposalTally","Proposal","element","id","status","type","title","description","tally","submit_time","voting_end_time","voting_start_time","total_deposit","contents","total","proposal_id","init","final_tally_result","content","value","newTally","ver","metadata","proposal_status","String","indexOf"],"sources":["/home/imstaked/explorer/src/libs/data/proposal.js"],"sourcesContent":["import compareVersions from 'compare-versions'\nimport ProposalTally from './proposal-tally'\n\nexport default class Proposal {\n  constructor() {\n    this.element = null\n\n    this.id = 0\n    this.status = 1\n    this.type = '-'\n    this.title = '-'\n    this.description = '-'\n    this.tally = new ProposalTally()\n    this.submit_time = '0000-00-00'\n    this.voting_end_time = '0000-00-00'\n    this.voting_start_time = '0000-00-00'\n    this.total_deposit = '-'\n    this.contents = null\n  }\n\n  init(element, total) {\n    this.element = element\n\n    this.id = element.proposal_id || element.id\n    this.status = element.status\n    this.tally = new ProposalTally().init(element.final_tally_result, total)\n    this.submit_time = element.submit_time\n    this.voting_end_time = element.voting_end_time\n    this.voting_start_time = element.voting_start_time\n    // eslint-disable-next-line prefer-destructuring\n    this.total_deposit = element.total_deposit[0]\n    this.contents = element.content.value || element.content\n    if (this.contents) {\n      this.title = this.contents.title\n      this.description = this.contents.description\n      this.type = element.content.type\n      if (element.content['@type']) {\n        this.type = element.content['@type']\n      }\n    }\n    return this\n  }\n\n  hello() {\n    return this.title\n  }\n\n  updateTally(newTally) {\n    this.tally = newTally\n  }\n\n  versionFixed(ver) {\n    if (compareVersions(ver, '0.46') >= 0) {\n      if (this.element.metadata) {\n        this.title = this.element.metadata.title || this.element.metadata\n        this.description = this.element.metadata.description || this.element.metadata\n      }\n    } else if (compareVersions(ver, '0.30') >= 0) {\n      switch (this.element.proposal_status) {\n        case 'Passed':\n          this.status = 3\n          break\n        case 'VotingPeriod':\n          this.status = 2\n          break\n        case 'Rejected':\n          this.status = 4\n          break\n        default:\n          // this.status = 1\n      }\n    }\n    if (String(this.status).indexOf('PASSED') > -1) {\n      this.status = 3\n    } else if (String(this.status).indexOf('VOTING') > -1) {\n      this.status = 2\n    } else if (String(this.status).indexOf('REJECTED') > -1) {\n      this.status = 4\n    } else if (String(this.status).indexOf('DEPOSIT') > -1) {\n      this.status = 1\n    }\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}